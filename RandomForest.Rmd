---
title: "RandomForest"
author: "Lars Vatten"
date: "2023-04-12"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Import dataset and remove irrelevant datapoints:
```{r}
songs <- read.csv("Spotify_Youtube.csv")
songs <- songs[, -c(1,2,3,4,5,7,10,19,20,21,22,23,24,25,26,27)]
songs <- na.omit(songs)
summary(songs)
head(songs)
str(songs)
library(GGally)
#ggpairs(songs)
```
Split into training and test set:
```{r}
set.seed(25)

train_size <- floor(0.9 * nrow(songs))
train_ind <- sample(seq_len(nrow(songs)), size = train_size)

train <- songs[train_ind, ]
test <- songs[-train_ind, ]
```


Random forest:
```{r}
library(randomForest)

model <- randomForest(Stream ~ ., data = train, proximity = TRUE)

model

prediction <- predict(model, test)

plot(c(1,2,3,4,5,6), head(prediction)) + plot(c(1,2,3,4,5,6), head(test$Stream))
```